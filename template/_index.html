{% extends '_base.html' %}

{% block content %}

{% for tune_type in tune_types %}
    <h2 class="tune-type-title">{{ tune_type|title }} Sets</h2>
    <hr class="hr-short">
    <ol>
    {% for set in set_list %}
        {% if tune_type == set.set_type %}
        <li class="set-name">
            {{ set.set_name() }}
            <div class="tune-additional-data">
                {% if set.reference_audios|length > 0 %}
                    <h4>Audio References</h4>
                    {% for audio in set.reference_audios %}
                        <div class="audio-container">
                            <h5 class="audio-title">{{ audio.title }}</h5>
                            <h5>Instrument: {{ audio.instruments }}</h5>
                            <audio controls>
                                <source src="static/audio/{{ audio.audio_file_name }}" type="audio/mp3">
                            </audio>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
            {% for tune in set.set_tune_list %}
                <a href="tune.html#{{ tune.slug_id() }}">
                    <div id="{{ tune.slug_id() }}" class="tune" >
                        <pre>{{ tune.abc_notation }}</pre>
                    </div>
                </a>
            {% endfor%}
        </li>
        {% endif %}
    {% endfor %}
    </ol>
{% endfor %}

{% endblock %}

{% block afterJavascript %}
<script type="text/javascript">
    var els = document.getElementsByClassName('tune');
    
    var visualOptions = { responsive: 'resize' };
    for (let index = 0; index < els.length; index++) {
        ABCJS.renderAbc(els[index].id,els[index].textContent,visualOptions)
        // ABCJS.renderAbc(els[index].id,els[index].textContent)
    }
</script>
{% endblock %}